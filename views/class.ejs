<%-include header %>

<!-- Class header -->
<section class="wrapper style2">
    <div class="inner">
        <h2><%= theClass.tag %></h2>
        <header class="align-center"><h2><%= theClass.className %></h4></header>
        <header class="align-center"><h3><%= theClass.description %></h3></header>
    </div>
</section>

<!-- Lesson list -->
<section class="wrapper style1">
    <div class="inner">
        <header class="align-center">
        <h1> Class lessons list </h1>
    </header>
    <div class="inner">
    <div class="row">
        <% theClass.lessons.forEach(function(lesson){%>
        <div class="4u 12u$(medium) box">
            <ul class="alt">
                <li>
                    <h4>
                        Lesson : <%= lesson.lessonName%>
                    </h4>
                </li>
                <li>
                    description: <%= lesson.description %>
                </li>
            </ul>
        </div>
        <%})%>
    </div>
    </div>
    </div>
    

</section>

<!-- Enroll the class -->
<section class="wrapper style 2">
    <div class="inner">
            <% if(enrolled){%>
            <ul class="actions align-center">
                <li class="button disabled align-center"> Enrolled </li>
            </ul>
            <%}else{%>
                <% if(user){ %>
                    <% if(theClass.producer == user.username){ %>
                        <ul class="actions align-center">
                            <li class="button disabled align-center"> You are the producer </li>
                        </ul>
                    <% }else{ %>
                        <form method="post">
                            <input type="submit" value="Enroll" name="enroll"/>
                        </form>
                    <%}%>
                <% }else{ %>
                    <form method="post">
                        <input type="submit" value="Enroll" name="enroll"/>
                    </form>
                <%}%>
            <%}%>
        </div>
</section>

<!-- Related topics-->
<section class="wrapper style 1">
    <div class="inner">
            <header>
                <h1> Some related topics </h1>
            </header>
            <div class="table-wrapper">
                <table>
                    <thead>
                    <tr>
                        <th>Author</th>
                        <th>Topic Title</th>
                        <th>Time</th>
                        <th>Views</th>
                    </tr>
                    </thead>
    
                    <tbody>
                    <% theClass.topics.forEach(function(topic){%>
                    <tr>
                        <td>
                            <a href="/user/<%= topic.author%>">
                                <% users.forEach(function(user){ %>
                                    <% if(user.username == topic.author){ %>
                                        <img src="../avatars/<%= user.avatar%>" width="50px" alt="user's avatar"/>
                                    <% }%>
                                <%})%>
                            </a>
                        </td>
                        <td>
                            <a href="/topic/detail/article?topicId=<%=topic._id%>">
                                <%= topic.topicName%>
                            </a>
                        </td>
                        <td><%= topic.postTime%></td>
                        <td><%= topic.viewer%></td>
                    </tr>
                    <%})%>
                    </tbody>
    
                    <tfoot>
                    <tr>
                        <td colspan="3"></td>
                        <td><a href="/topic/detail?id=<%= theClass._id%>">View more content</a></td>
                    </tr>
                    </tfoot>
                </table>
            </div>
    
        </div>
</section>
<!-- Class Edit -->

<% if(user){ %>
    <% if (theClass.producer == user.username){%>
        <section>
            <div>
                <ul class="actions">
                    <li class="button small"> <a href="edit?id=<%= theClass._id%>">Edit</a></li>
                    <li class="button small"> <a href="delete?id=<%= theClass._id%>">Delete</a> </li>
                </ul>
            </div>
        </section>
    <%}%>
<%}%>


<%- include footer %>